<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="By SA23204166金亦成" />

<meta name="date" content="2023-12-05" />

<title>SA23204166function</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">SA23204166function</h1>
<h4 class="author">By SA23204166金亦成</h4>
<h4 class="date">2023-12-05</h4>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(SA23204166)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(igraph)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;igraph&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     decompose, spectrum</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     union</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span></code></pre></div>
<div id="函数1rs_pa" class="section level2">
<h2>函数1：RS_PA</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>RS_PA <span class="ot">&lt;-</span> <span class="cf">function</span>(X,T,a) {</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  n<span class="ot">=</span><span class="fu">dim</span>(X)[<span class="dv">1</span>]</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  sig<span class="ot">=</span><span class="fu">svd</span>(X)<span class="sc">$</span>d</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  sig0<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">0</span>,n<span class="sc">*</span>T),<span class="at">nrow =</span> T)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>T) {</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>    mat<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">rbinom</span>(n<span class="sc">^</span><span class="dv">2</span>,<span class="dv">1</span>,<span class="fl">0.5</span>)<span class="sc">-</span><span class="dv">1</span>,<span class="at">nrow =</span> n)</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>    upper_triangle <span class="ot">&lt;-</span> <span class="fu">upper.tri</span>(mat)</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>    s_m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(mat), <span class="at">ncol =</span> <span class="fu">ncol</span>(mat))</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>    s_m[upper_triangle] <span class="ot">&lt;-</span> mat[upper_triangle]</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>    s_m[<span class="fu">lower.tri</span>(s_m)] <span class="ot">&lt;-</span> <span class="fu">t</span>(s_m)[<span class="fu">lower.tri</span>(s_m)]</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>    sig0[t,]<span class="ot">=</span><span class="fu">svd</span>(X<span class="sc">*</span>s_m)<span class="sc">$</span>d</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>  }</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>  sig1<span class="ot">=</span><span class="fu">apply</span>(sig0, <span class="dv">2</span>, quantile, <span class="at">probs =</span> a)</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>  k<span class="ot">=</span><span class="fu">which</span>(sig <span class="sc">&lt;</span> sig1)[<span class="dv">1</span>]<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>  embedding_mat<span class="ot">=</span><span class="fu">svd</span>(X)<span class="sc">$</span>u[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>k)]</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">k=</span>k,<span class="at">embedding_mat=</span>embedding_mat))</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a>}</span></code></pre></div>
<div id="函数1背景" class="section level3">
<h3>函数1背景：</h3>
<p>平行分析（PA）是一种选取主成分个数的方法，可以通过以下几个步骤来完成：首先，生成多组随机数据的矩阵，这些矩阵和真实的数据矩阵要有相同的变量个数和被试的个数。然后，求出这组随机数据矩阵的特征值，并计算这些特征值的上<span class="math inline">\(\alpha\)</span>分位数。最后，通过比较真实数据中特征值的碎石图和这组随机矩阵的平均特征值的曲线，我们可以找到两条特征值曲线的交点，根据交点的位置，我们就可以确定要抽取主成分的绝对最大数目。如果真实数据的特征值落在随机矩阵的平均特征值曲线之上，则保留这些主成分；反之，则舍弃这些主成分。</p>
<p>为了解决具有异质噪声的数据的主成分个数选取问题，Hong(2020)中提出了随机符号翻转平行分析的方法，他将数据矩阵的每个元素进行了随机符号翻转，得到新的数据，他说明在此操作之下，数据中信号的部分被完全破坏掉同时误差的部分仍保留，因此原先数据比后得到数据主成分大的部分是该保留的主成分，由此合理的选取了具有异质噪声的数据中主成分的个数。但是给文章中限制了数据中的误差部分的范数恒定的条件，但是一般的随机图数据没法保证该条件。在我的毕业设计中，我和韩潇老师通过理论证明，发现这种方法也对于一般的随机图，只要随机图中的每个信号的信号强度随着节点个数n的变化保持在同一量级即可，且通过这种方式求得的显著的特征值的个数可以被视为是随机图中的社区个数。</p>
<p>由此我构造了一个R函数RS_PA，只要输入一个随机图的邻接矩阵，通过该函数即可通过上述的方法识别出该随机图的显著的特征值的个数，也就是给出该随机图中蕴含的潜在的社区个数。</p>
</div>
<div id="函数1说明" class="section level3">
<h3>函数1说明：</h3>
<div id="输入" class="section level4">
<h4>输入：</h4>
<ul>
<li>X:数据随机图的邻接矩阵,n个节点,则输入一个n行n列的0-1邻接矩阵</li>
<li>T:进行重复Random Signflips的试验次数</li>
<li>a:平行分析所采用的分位数</li>
</ul>
</div>
<div id="输出" class="section level4">
<h4>输出：</h4>
<ul>
<li>k:通过上述背景中Random
Signflip平行分析得到的随机图邻接矩阵的显著特征值的个数，即随机图中潜在的社区个数</li>
<li>embedding_mat:通过上述方法获得潜在社区数k之后，通过PCA取前k列特征作为每个节点的嵌入向量得到的嵌入矩阵</li>
</ul>
</div>
</div>
<div id="函数1例子" class="section level3">
<h3>函数1例子：</h3>
<div id="模拟数据" class="section level4">
<h4>模拟数据：</h4>
<ul>
<li>创建一个ER随机图邻接矩阵sim_data，则理论社区个数k=1，取大小为50个节点，相连概率p为0.2的ER随机图,取T为300，a为0.95</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>mat<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">50</span><span class="sc">^</span><span class="dv">2</span>,<span class="dv">1</span>,<span class="fl">0.2</span>),<span class="at">ncol=</span><span class="dv">50</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>upper_triangle <span class="ot">&lt;-</span> <span class="fu">upper.tri</span>(mat)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>sim_data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(mat), <span class="at">ncol =</span> <span class="fu">ncol</span>(mat))</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>sim_data[upper_triangle] <span class="ot">&lt;-</span> mat[upper_triangle]</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>sim_data[<span class="fu">lower.tri</span>(sim_data)] <span class="ot">&lt;-</span> <span class="fu">t</span>(sim_data)[<span class="fu">lower.tri</span>(sim_data)]</span></code></pre></div>
<ul>
<li>将ER随机图邻接矩阵sim_data作用上RS_PA，观察得到的k社区个数也为1</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">RS_PA</span>(sim_data,<span class="dv">300</span>,<span class="fl">0.95</span>))</span></code></pre></div>
<pre><code>## $k
## [1] 1
## 
## $embedding_mat
##  [1] -0.14356225 -0.14124234 -0.12556183 -0.11900381 -0.19216776 -0.18387745
##  [7] -0.10794476 -0.07921736 -0.18364921 -0.13105021 -0.07742354 -0.12994914
## [13] -0.13835058 -0.17002260 -0.11676248 -0.10844166 -0.16125967 -0.10138959
## [19] -0.11800020 -0.15061443 -0.12929497 -0.21752225 -0.14331182 -0.19365313
## [25] -0.13073908 -0.09552882 -0.11766429 -0.10449201 -0.15931398 -0.09874763
## [31] -0.18101508 -0.21667757 -0.15954106 -0.20028560 -0.11195533 -0.08575498
## [37] -0.15609329 -0.15053321 -0.16152257 -0.12013775 -0.09748688 -0.12145332
## [43] -0.13920882 -0.09577642 -0.06242600 -0.13294799 -0.12314412 -0.16291542
## [49] -0.18153422 -0.10384129</code></pre>
</div>
<div id="真实数据" class="section level4">
<h4>真实数据：</h4>
<ul>
<li>Dolphins
dataset:该数据集包含了由Lusseau等人（2003年）编制的，位于新西兰Doubtful
Sound的一个社群中的62只海豚之间频繁关联的无向社交网络。数据类型为igraph中图。结果k为3.</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">data</span>(dolphins)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>dolphins_mat<span class="ot">=</span><span class="fu">get.adjacency</span>(dolphins,<span class="at">sparse =</span> <span class="cn">FALSE</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="fu">RS_PA</span>(dolphins_mat,<span class="dv">300</span>,<span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## $k
## [1] 3
## 
## $embedding_mat
##                [,1]          [,2]          [,3]
##  [1,] -0.1285035261  0.0001003140 -0.0589454102
##  [2,] -0.0420761459 -0.2285005828 -0.0143657679
##  [3,] -0.0397571169 -0.0002431278 -0.0370121065
##  [4,] -0.0793347556  0.0041732314 -0.0251933729
##  [5,] -0.0292873946  0.0050403942  0.0738052681
##  [6,] -0.0065592559 -0.2016212753  0.0149288387
##  [7,] -0.0121912577 -0.3095742044  0.0172829865
##  [8,] -0.0429009873 -0.1050630410 -0.0438895296
##  [9,] -0.1431021372 -0.0011927774  0.0366298438
## [10,] -0.0121973848 -0.3403849096  0.0223768720
## [11,] -0.0752534741  0.0001430855  0.0175711448
## [12,] -0.0292873946  0.0050403942  0.0738052681
## [13,] -0.0390761433  0.0042136202 -0.0534811414
## [14,] -0.0150046939 -0.3842550386  0.0221080341
## [15,] -0.3157828495  0.0264759203 -0.2657498540
## [16,] -0.1641758055  0.0133516075  0.1915102251
## [17,] -0.2079942595  0.0162791581 -0.2124449626
## [18,] -0.0175124404 -0.3365453024  0.0129388031
## [19,] -0.2024946945  0.0252895248  0.3134501303
## [20,] -0.0206747806 -0.1160072548 -0.0199148011
## [21,] -0.1844773884 -0.0072502762 -0.0730563005
## [22,] -0.2073514014  0.0266470115  0.1805462890
## [23,] -0.0024344426 -0.0566926668  0.0026786415
## [24,] -0.0873621419  0.0017796370  0.1392173982
## [25,] -0.1932135714  0.0263101228  0.2494335280
## [26,] -0.0059460504 -0.0937573536 -0.0006133788
## [27,] -0.0089439590 -0.0781806704 -0.0052965494
## [28,] -0.0163171923 -0.1418468385 -0.0106050940
## [29,] -0.0682235028 -0.0518287672 -0.0273729729
## [30,] -0.2117630782  0.0296260582  0.2653495717
## [31,] -0.0407472509 -0.0507946613 -0.0363729410
## [32,] -0.0024344426 -0.0566926668  0.0026786415
## [33,] -0.0038559339 -0.1256341904  0.0096218195
## [34,] -0.2810986922  0.0250133600 -0.2583331704
## [35,] -0.1388280941  0.0125881037 -0.1711012810
## [36,] -0.0294376481  0.0049906513  0.0549337042
## [37,] -0.1327621009 -0.0508774820 -0.0278235204
## [38,] -0.3005620547  0.0168140439 -0.1486566279
## [39,] -0.1966176443  0.0165059657 -0.2495945864
## [40,] -0.0208710430 -0.0736165618 -0.0014212973
## [41,] -0.2078719128 -0.0107412736 -0.1435419740
## [42,] -0.0152435699 -0.2768673526  0.0102497244
## [43,] -0.0809501012 -0.0087004608 -0.0394609484
## [44,] -0.1903393414  0.0206254024 -0.1530229678
## [45,] -0.0778023734  0.0036387355 -0.1098808920
## [46,] -0.2850052153  0.0315206134  0.3437876622
## [47,] -0.0297165089  0.0039435672 -0.0407595329
## [48,] -0.0803706235 -0.0199333838 -0.0450561500
## [49,] -0.0024154933 -0.0650460065  0.0043388365
## [50,] -0.0234297535  0.0027848391 -0.0438602527
## [51,] -0.2176917909  0.0190791321 -0.0307951272
## [52,] -0.2106822123  0.0299213474  0.3565060208
## [53,] -0.1295642889  0.0104217367 -0.0814715334
## [54,] -0.0336869264  0.0040598884 -0.0414118348
## [55,] -0.0230020073 -0.3042968594 -0.0015674216
## [56,] -0.0521098320  0.0072895363  0.1134524625
## [57,] -0.0026065499 -0.0861133250  0.0066686178
## [58,] -0.0173761264 -0.3861333249  0.0209581428
## [59,] -0.0273322483  0.0027805089 -0.0516720456
## [60,] -0.1118186231 -0.0005095432  0.1074269473
## [61,] -0.0005360218 -0.0211636806  0.0019919466
## [62,] -0.0519914048  0.0034753578 -0.0470111059</code></pre>
<ul>
<li>Football
dataset:该数据集包含了由M.Girvan和M.Newman编制的，涵盖了2000年秋季常规赛季美国大学分区IA间橄榄球比赛的网络。数据类型为igraph中图。结果k为11.</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">data</span>(football)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>football_mat<span class="ot">=</span><span class="fu">get.adjacency</span>(football,<span class="at">sparse =</span> <span class="cn">FALSE</span>)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="fu">RS_PA</span>(football_mat,<span class="dv">300</span>,<span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## $k
## [1] 11
## 
## $embedding_mat
##               [,1]          [,2]         [,3]          [,4]         [,5]
##   [1,] -0.10650475  0.0199591221 -0.082162375 -0.1072673754  0.029452541
##   [2,] -0.09637427 -0.1408438642 -0.095956248 -0.0592331541  0.168341820
##   [3,] -0.11626309  0.0137977947  0.171286232  0.0908502316 -0.074201044
##   [4,] -0.10625468  0.0648499568  0.023740505  0.1781760770  0.009546932
##   [5,] -0.10119713  0.0880039111 -0.065176105 -0.0891453026 -0.009411929
##   [6,] -0.10227926  0.0863061436 -0.027515685  0.1629864770  0.022572100
##   [7,] -0.11285541 -0.0052089018  0.174427514  0.0109145646 -0.068202851
##   [8,] -0.12073572  0.1516504366  0.023106768 -0.1611822863 -0.022394822
##   [9,] -0.10782354  0.1533033833 -0.010255854 -0.2067718780 -0.032820618
##  [10,] -0.10654016  0.1059760468 -0.034424346 -0.1477614555 -0.022325563
##  [11,] -0.09026344  0.0703049683  0.008978861  0.1715701489  0.017758229
##  [12,] -0.07987206  0.0517908932 -0.045341132  0.0499754567 -0.005900582
##  [13,] -0.07110782 -0.0862698422  0.111343989 -0.0022086232 -0.071297185
##  [14,] -0.10599373 -0.0163641172  0.147557048  0.0434098500 -0.053501937
##  [15,] -0.07662535 -0.0708074503  0.160677024  0.0123484072 -0.067623564
##  [16,] -0.11630351  0.0067681002  0.162628026  0.0356937676 -0.079365009
##  [17,] -0.10379614  0.0657953064 -0.054449245 -0.0599449769 -0.015246173
##  [18,] -0.08178226 -0.0884633379 -0.121579154 -0.0043290074 -0.179358274
##  [19,] -0.07511225 -0.1094663772  0.149108769 -0.0188994041 -0.027158040
##  [20,] -0.08347500 -0.1263323614  0.044803566 -0.0733638512  0.136174931
##  [21,] -0.08120819 -0.0865330575 -0.134930014 -0.0146049732 -0.187471603
##  [22,] -0.10997913  0.1314225534  0.004960995 -0.1699797678 -0.050759562
##  [23,] -0.11033524  0.1502443801  0.011105255 -0.2095411912 -0.042865899
##  [24,] -0.10449030  0.1097181504 -0.052640626 -0.1504592495 -0.014243611
##  [25,] -0.08032024  0.0124223827 -0.073969986  0.0271814602 -0.002160708
##  [26,] -0.09337002 -0.1090690982 -0.071788242 -0.0210287870  0.173061158
##  [27,] -0.07090899 -0.0802201532  0.100060354  0.0142433868 -0.066113046
##  [28,] -0.07950334 -0.1192498828 -0.127576475 -0.0031086842 -0.160519067
##  [29,] -0.07011288  0.0305224535 -0.042010493 -0.0404880729 -0.041301462
##  [30,] -0.08575608 -0.1054278314  0.044648528 -0.0705279666  0.132255819
##  [31,] -0.08754214 -0.1035306211  0.031224318 -0.0813729887  0.147241783
##  [32,] -0.08254563 -0.1084960580  0.168571717 -0.0240267234 -0.012607232
##  [33,] -0.10921015  0.0096472105  0.162194655  0.0169861348 -0.069096930
##  [34,] -0.08335791 -0.1246082004 -0.073590944 -0.0607923103  0.188687631
##  [35,] -0.07680854 -0.1119812295  0.149663772 -0.0229448251 -0.013144212
##  [36,] -0.08845101 -0.1124621120  0.040611788 -0.0733546333  0.117344668
##  [37,] -0.05613821 -0.0767569991  0.017393325 -0.0109723896 -0.015679277
##  [38,] -0.08602324 -0.1386634855 -0.083270584 -0.0466282111  0.163745149
##  [39,] -0.08048342 -0.0667060956  0.135182706 -0.0105627903 -0.065983099
##  [40,] -0.10438343 -0.0185881601  0.187779919  0.0239968153 -0.076401263
##  [41,] -0.10297295  0.1022536499 -0.001058882  0.1065159951  0.021761718
##  [42,] -0.09914470  0.0972771471 -0.055959756 -0.0861159294  0.006178168
##  [43,] -0.04830605 -0.0706346981  0.050355518 -0.0080590634 -0.011943309
##  [44,] -0.07456233 -0.1052851546  0.107407409 -0.0146181775 -0.053119060
##  [45,] -0.08598227 -0.1021322640 -0.063800792  0.0086045472  0.038094328
##  [46,] -0.09053178 -0.1381054296 -0.074090705 -0.0372581747  0.153885747
##  [47,] -0.11957723  0.1155266091 -0.025678134  0.0628745610  0.067100906
##  [48,] -0.11005414  0.0195428197  0.167071644  0.0149721944 -0.078506579
##  [49,] -0.09250498 -0.0425455399 -0.090646595  0.0807798454 -0.019730806
##  [50,] -0.11725320  0.0914471930 -0.039438666  0.1304045672  0.080071469
##  [51,] -0.07434649  0.0537684466 -0.030671983 -0.0775267134 -0.001684014
##  [52,] -0.10425895  0.1339289435  0.001379249 -0.1881070404 -0.014812982
##  [53,] -0.09286764  0.0677774129 -0.014992682  0.1753478099  0.031133572
##  [54,] -0.12258224  0.0716261593 -0.071734345  0.1298377737  0.102649127
##  [55,] -0.07602432 -0.0946973883  0.171098834 -0.0125543891 -0.033334360
##  [56,] -0.08876306 -0.1187957181  0.089403905 -0.0713088894  0.124740824
##  [57,] -0.07554442 -0.1027311913 -0.122296430  0.0078005368 -0.176509503
##  [58,] -0.07560350 -0.0858235813 -0.076385173  0.0299925280 -0.021218924
##  [59,] -0.07914452 -0.0134554334 -0.009165770  0.0503384512 -0.010881100
##  [60,] -0.05456842 -0.0461816096 -0.033452755  0.0278216960 -0.077844766
##  [61,] -0.10194442 -0.0067164633  0.162106900  0.0559606643 -0.085551862
##  [62,] -0.08262006 -0.1038346760  0.136170098 -0.0031578534 -0.065325525
##  [63,] -0.08251606 -0.1266076897 -0.125977771 -0.0114354297 -0.137547697
##  [64,] -0.06201496 -0.0571774236 -0.034897432  0.0150619833 -0.048890450
##  [65,] -0.10645206  0.0198268057  0.140471178 -0.0009225694 -0.082677365
##  [66,] -0.08141047 -0.0949547955 -0.147723456 -0.0062451834 -0.184190240
##  [67,] -0.08240788 -0.0776520553 -0.103375922  0.0444553950 -0.074627488
##  [68,] -0.12769278  0.1244421363 -0.062273887  0.0600211910  0.079906110
##  [69,] -0.11019860  0.1456098479  0.010778173 -0.1804741610 -0.032555906
##  [70,] -0.08927472  0.0218199594 -0.088369416  0.0112311916 -0.021420766
##  [71,] -0.08054424 -0.1108659726 -0.131531197 -0.0059701471 -0.158518197
##  [72,] -0.07685587 -0.0755125620  0.162567904  0.0156288716 -0.046754326
##  [73,] -0.10099817  0.0665231982  0.032070538  0.1616371218  0.011042621
##  [74,] -0.11991200  0.1231649040 -0.039390184  0.0835928659  0.084327354
##  [75,] -0.10437351  0.0804473480  0.022648925  0.1726975112  0.031269419
##  [76,] -0.07767823 -0.0686702427 -0.093822768  0.0575193471 -0.065727212
##  [77,] -0.07728074 -0.1096764927 -0.148381573  0.0132318657 -0.191418418
##  [78,] -0.11007827  0.1486818666  0.001918109 -0.1581365915 -0.012857148
##  [79,] -0.10431655  0.1481675911 -0.009576103 -0.2097116476 -0.034542295
##  [80,] -0.08637683 -0.1278919283  0.062881177 -0.0781937778  0.141637670
##  [81,] -0.09040906 -0.0728754058 -0.007306354 -0.0318648886  0.102866978
##  [82,] -0.10332748  0.0871413901 -0.010220936  0.1606309902  0.038160160
##  [83,] -0.10091634  0.0121041027  0.055122704 -0.0314707628  0.052031445
##  [84,] -0.11647964  0.1052488302 -0.056924537  0.1382875225  0.091603590
##  [85,] -0.10215021  0.0876685192 -0.024345993  0.1956214000  0.045886043
##  [86,] -0.06816763 -0.0744010123  0.126567426 -0.0062264821 -0.039689703
##  [87,] -0.08790178 -0.0651224356 -0.089609009  0.0529609098 -0.020725638
##  [88,] -0.08381313 -0.0803907386 -0.150498108  0.0021837958 -0.173271858
##  [89,] -0.12129515  0.0813064367 -0.061762268  0.1201127710  0.105758294
##  [90,] -0.09146161 -0.1270963491 -0.051024140 -0.0370773005  0.193419201
##  [91,] -0.07560123  0.0581573342 -0.051882579 -0.0394234043 -0.008278834
##  [92,] -0.08783152 -0.0666913066 -0.070570040  0.0159911861  0.005113271
##  [93,] -0.08991529 -0.0762445609 -0.015376463  0.0396347405 -0.042833659
##  [94,] -0.09410824  0.0479058007 -0.050735227 -0.0868723247  0.016136949
##  [95,] -0.08071990 -0.1029620187  0.062107665 -0.0738129068  0.131566061
##  [96,] -0.07483158 -0.1012076253 -0.141629170 -0.0046578441 -0.149888249
##  [97,] -0.07388314 -0.0937076164 -0.143837028  0.0154214566 -0.184809398
##  [98,] -0.05890302 -0.0028368662 -0.038774639  0.0677133359 -0.020314380
##  [99,] -0.09621720  0.0782133016 -0.023399174  0.1536915879  0.023125542
## [100,] -0.07538776 -0.0944583126  0.154575698 -0.0065247795 -0.021557999
## [101,] -0.10650158 -0.0001352815  0.176052294  0.0421045126 -0.063570078
## [102,] -0.08170829 -0.0881366395  0.031149667 -0.0855923338  0.131663669
## [103,] -0.09032790  0.0516774533  0.013830848  0.1557533495  0.033117559
## [104,] -0.08173595 -0.1200175628 -0.081847996 -0.0256401419  0.156895810
## [105,] -0.11371015  0.0852253409 -0.075354965 -0.0416493458 -0.002831515
## [106,] -0.08191021 -0.1336669299 -0.083449609 -0.0461819338  0.166806026
## [107,] -0.10502559 -0.0307036244  0.125885904  0.0361086116 -0.077908524
## [108,] -0.09160092  0.0692705792 -0.021448381  0.1721568241  0.031082831
## [109,] -0.10100119  0.1460359579 -0.005368571 -0.2024390212 -0.033717246
## [110,] -0.08725875 -0.1423371794 -0.063666343 -0.0569488861  0.196810862
## [111,] -0.11494921  0.0786449606 -0.037477871  0.1033116678  0.089918994
## [112,] -0.11121042  0.1513043125  0.009060106 -0.1863564560 -0.032410444
## [113,] -0.07300983 -0.0606952068 -0.075123611  0.0559247275 -0.047102254
## [114,] -0.07044481 -0.0842228302 -0.136949140 -0.0020996866 -0.187397400
## [115,] -0.11770248  0.0937595823 -0.036262401  0.1039134470  0.074594636
##                [,6]          [,7]         [,8]          [,9]        [,10]
##   [1,] -0.070362343  0.0257031398 -0.119099357  0.2701023888 -0.008869938
##   [2,]  0.054919800  0.1763945781 -0.029521108 -0.0004950354  0.073890854
##   [3,]  0.057617219  0.1395117312  0.090201054  0.0849643407 -0.057110315
##   [4,] -0.169442089  0.0991148292 -0.013624643 -0.0529785988 -0.031602778
##   [5,] -0.093685335  0.0065565436 -0.124937061  0.2491906653  0.010531445
##   [6,] -0.198411889  0.0817163363 -0.014225023 -0.0150389458 -0.008572068
##   [7,]  0.100472176  0.0885047064  0.109190209  0.0729103057 -0.088030804
##   [8,]  0.002078858  0.0222585490  0.079279632 -0.1654806583  0.022877977
##   [9,] -0.026186897  0.0216182500  0.034068797 -0.0953047399  0.058245213
##  [10,] -0.055920258  0.0213733418 -0.085273760  0.2349596005  0.021391705
##  [11,] -0.160734932  0.1006806622  0.010770954 -0.0386493103 -0.025236117
##  [12,] -0.107813463  0.0282394644 -0.041339761  0.0352932875 -0.006562987
##  [13,] -0.020691085 -0.0455224159 -0.148440641 -0.0496669001  0.070220871
##  [14,]  0.144891834  0.1074200975  0.077911681  0.0968718921 -0.036890727
##  [15,] -0.011143509 -0.0252018839 -0.134545239 -0.0308664511  0.106503007
##  [16,]  0.140899698  0.0724782995  0.107263036  0.0911818142 -0.008614463
##  [17,] -0.064803246 -0.0159868793 -0.161449610  0.2541727450 -0.007665401
##  [18,]  0.008651730  0.0062382197 -0.076689218 -0.0289457622 -0.130579407
##  [19,] -0.059284742 -0.0945367596 -0.159650097 -0.0730503642  0.102798468
##  [20,] -0.094468436 -0.1187804142  0.078244690 -0.0111475974 -0.162652089
##  [21,]  0.013716690 -0.0010225614 -0.009308710 -0.0789292709 -0.092790170
##  [22,]  0.038988322  0.0106374322  0.069208856 -0.1707702096  0.028783380
##  [23,] -0.008589129  0.0315013925  0.051520008 -0.0932847287  0.055841038
##  [24,] -0.072719334  0.0087699703 -0.101307745  0.2202296286  0.028899153
##  [25,] -0.016070350 -0.0041032102 -0.024380491  0.0067685406  0.013780717
##  [26,]  0.105442217  0.1849994664 -0.031441572 -0.0192535085  0.089688658
##  [27,] -0.054777101 -0.0449101013 -0.151038851 -0.0697660409  0.087311196
##  [28,]  0.021160134  0.0402429780 -0.053111997 -0.0661014399 -0.099158030
##  [29,] -0.052966011 -0.0031768726 -0.063328994  0.0227972162  0.006053711
##  [30,] -0.107191995 -0.1447515594  0.116870210  0.0149924062 -0.192364926
##  [31,] -0.100126152 -0.1094110924  0.118696112 -0.0037358282 -0.197344546
##  [32,] -0.045395120 -0.0899143136 -0.125768626 -0.0622718850  0.056108826
##  [33,]  0.144822680  0.0707539442  0.094369085  0.0695309325 -0.047501041
##  [34,]  0.053059606  0.1785757981 -0.044170183  0.0036569726  0.063320670
##  [35,] -0.073030423 -0.1102120733 -0.136911574 -0.0683172014  0.074232170
##  [36,] -0.108804736 -0.1474028634  0.101559306  0.0404487938 -0.146690947
##  [37,] -0.013434537 -0.0226138916 -0.054130041 -0.0509960546 -0.009704050
##  [38,]  0.070698777  0.1836823836 -0.046866247 -0.0372774091  0.065748262
##  [39,] -0.039483440 -0.0491992968 -0.177969988 -0.0078796771  0.106581651
##  [40,]  0.105365699  0.0815967404  0.077109578  0.0954982162 -0.044562585
##  [41,] -0.171061901  0.0916484508  0.012696524 -0.0770734982 -0.004780977
##  [42,] -0.065213429 -0.0050221987 -0.122674298  0.2405192374  0.008316157
##  [43,] -0.044238093 -0.0694230486 -0.039049247 -0.0321032008  0.054203432
##  [44,] -0.044613176 -0.0708493837 -0.149148269 -0.0723341305  0.060918664
##  [45,] -0.047953835 -0.1220278743  0.202135886  0.0557161120  0.150025356
##  [46,]  0.086711126  0.1945810396 -0.012917467 -0.0197600504  0.091047714
##  [47,]  0.209456139 -0.1361905451 -0.051511619 -0.0683212862 -0.032175869
##  [48,]  0.129071737  0.0805046109  0.089062228  0.0716385360 -0.041325436
##  [49,]  0.005653530 -0.1333709531  0.168107686  0.0359237520  0.208835755
##  [50,]  0.191029131 -0.1508438470 -0.047705446 -0.0342395684 -0.017720463
##  [51,] -0.051938100 -0.0088273322  0.007917003 -0.0429732569 -0.008958592
##  [52,] -0.040842368  0.0168409893  0.074204913 -0.1752252664  0.027917726
##  [53,] -0.145175602  0.0620486256  0.021678176 -0.0631418942  0.015813383
##  [54,]  0.183280224 -0.1504293967 -0.037512804 -0.0369586085  0.034839660
##  [55,] -0.037648625 -0.0701590862 -0.139778223 -0.0480909328  0.092263406
##  [56,] -0.075637078 -0.1017597338  0.058824719 -0.0134130311 -0.186510143
##  [57,]  0.033221588  0.0252942679  0.004883694 -0.0335221459 -0.090000337
##  [58,] -0.016516922 -0.0856697908  0.162291888  0.0504476336  0.215959039
##  [59,]  0.022830161 -0.0240666577  0.001323000 -0.0203462802 -0.085678350
##  [60,]  0.006389425 -0.0020006650  0.039166196 -0.0049384370 -0.019454245
##  [61,]  0.091292598  0.1120396476  0.094326278  0.0948120076 -0.046182273
##  [62,] -0.028218646 -0.0681278576 -0.128314413 -0.0620718519  0.126506160
##  [63,]  0.035950164  0.0600467608 -0.061775604 -0.0767071716 -0.082954772
##  [64,]  0.008272858  0.0195357307  0.032865686 -0.0008514785 -0.008752232
##  [65,]  0.110143790  0.1151179079  0.107722987  0.1159909942 -0.055698763
##  [66,]  0.005363076  0.0048168955 -0.022040703 -0.0082818730 -0.104006877
##  [67,] -0.020636387 -0.1031563310  0.172460320  0.0504684248  0.181258707
##  [68,]  0.170389702 -0.1522380557 -0.122653378  0.0399020137 -0.033017567
##  [69,]  0.025113082  0.0091234831  0.060830142 -0.1432371515  0.048717189
##  [70,] -0.007366399 -0.0385328715 -0.057995769  0.0309015208 -0.018097702
##  [71,]  0.021301610  0.0362803420 -0.063764190 -0.0762398311 -0.107589619
##  [72,] -0.049127381 -0.0432628620 -0.147209513 -0.0490724435  0.115477324
##  [73,] -0.163117880  0.1005688769 -0.020007267 -0.0204002593 -0.016019546
##  [74,]  0.170218271 -0.1342486672 -0.057522015 -0.0902788870 -0.035295833
##  [75,] -0.141912563  0.0912562803  0.016304735 -0.0571253832 -0.050383165
##  [76,] -0.031837920 -0.0906909540  0.172550561  0.0257756716  0.189904915
##  [77,]  0.015895225 -0.0002967394  0.017709750 -0.0595268584 -0.069954763
##  [78,] -0.016431143  0.0098717864  0.071562291 -0.1794518373  0.037279820
##  [79,] -0.030542811  0.0188973443  0.043113692 -0.1300289687  0.060412934
##  [80,] -0.093862900 -0.1190961337  0.055690089 -0.0179667582 -0.187337702
##  [81,] -0.022946861 -0.0677558846  0.046341358  0.0489714532 -0.022979248
##  [82,] -0.162788152  0.0613347060 -0.020074444 -0.0288098663 -0.038796715
##  [83,] -0.068474947 -0.0138458536  0.083775404  0.0128797952 -0.119813849
##  [84,]  0.154787861 -0.1409738922 -0.088778099 -0.0474607521 -0.047719432
##  [85,] -0.122624946  0.0423817852 -0.013937683 -0.0693979520 -0.023707097
##  [86,] -0.020142002 -0.0445831204 -0.120158336 -0.0333444428  0.079433695
##  [87,] -0.006624369 -0.1303255309  0.174705376  0.0612709656  0.205641288
##  [88,]  0.008898852 -0.0034928890 -0.032389635 -0.0058325216 -0.099143442
##  [89,]  0.182442660 -0.1306404786 -0.090135541 -0.0510610839 -0.039705432
##  [90,]  0.081561300  0.1582702709 -0.060475209 -0.0449319509  0.072542310
##  [91,] -0.076949888  0.0145545598 -0.052074348  0.0634755830  0.008911789
##  [92,] -0.044520422 -0.1343434253  0.173375044  0.1099408021  0.178882466
##  [93,] -0.003101827 -0.1017769327  0.191369821  0.0812052337  0.207163051
##  [94,] -0.077543223 -0.0254711234 -0.076918094  0.2794382470  0.010466488
##  [95,] -0.105414231 -0.1339415592  0.084156843 -0.0037022808 -0.214201828
##  [96,]  0.027606440  0.0414870938 -0.055419944 -0.0590450329 -0.121179083
##  [97,]  0.009640666 -0.0168499484  0.017533306 -0.0372974661 -0.068357406
##  [98,] -0.062300635 -0.0048533569  0.055104702  0.0020866366  0.045561166
##  [99,] -0.168394427  0.0652352684  0.044524929 -0.0814015602  0.032754668
## [100,] -0.019478532 -0.0364098466 -0.144734221 -0.0564386205  0.121776871
## [101,]  0.089578824  0.1090310254  0.097506029  0.0872197955 -0.061769777
## [102,] -0.082654294 -0.0922308194  0.090525135 -0.0279541313 -0.202559718
## [103,] -0.142395819  0.1289381270  0.019077750 -0.0603648565 -0.009806708
## [104,]  0.058003201  0.2084212891 -0.044632325 -0.0469391114  0.070761085
## [105,] -0.049844585 -0.0204157114 -0.149585300  0.2642397573 -0.023019945
## [106,]  0.073160400  0.1884398955 -0.041104279 -0.0330136620  0.072336756
## [107,]  0.131394453  0.1170485268  0.126575762  0.1100310379 -0.028327048
## [108,] -0.145139314  0.0589426932  0.013885085 -0.0610769305  0.008930503
## [109,] -0.020009089  0.0212294794  0.040900414 -0.1033429134  0.057177965
## [110,]  0.050698903  0.1651844821 -0.014246575 -0.0323508757  0.032815371
## [111,]  0.199848202 -0.1443967188 -0.065635804 -0.0193309778 -0.042975188
## [112,]  0.022817112  0.0154387238  0.058709765 -0.1312619886  0.045013034
## [113,] -0.045128678 -0.0754836322  0.164766254  0.0402391077  0.176499938
## [114,]  0.008219286  0.0080976463 -0.034085975 -0.0493165920 -0.128614921
## [115,]  0.200753655 -0.1452708459 -0.082626056  0.0040079491 -0.052765960
##                [,11]
##   [1,]  0.0571397596
##   [2,]  0.0259490995
##   [3,] -0.0058101885
##   [4,]  0.0064018411
##   [5,] -0.0287675359
##   [6,] -0.0975983536
##   [7,] -0.0187795901
##   [8,]  0.0725362131
##   [9,]  0.0123033300
##  [10,]  0.1102201644
##  [11,] -0.0173559437
##  [12,] -0.3544917844
##  [13,]  0.0035912442
##  [14,] -0.0397029984
##  [15,] -0.0113378774
##  [16,] -0.0377709787
##  [17,]  0.1172309264
##  [18,]  0.0681291524
##  [19,]  0.0107143661
##  [20,]  0.0020360135
##  [21,]  0.0658253843
##  [22,]  0.0609421377
##  [23,]  0.0511621669
##  [24,]  0.0421575834
##  [25,] -0.3617345172
##  [26,] -0.0552906539
##  [27,]  0.0124760916
##  [28,]  0.0602954589
##  [29,] -0.3659494666
##  [30,]  0.0078424589
##  [31,] -0.0514199222
##  [32,]  0.0086954966
##  [33,] -0.0185190275
##  [34,]  0.0121722136
##  [35,]  0.0220914580
##  [36,]  0.0100674628
##  [37,]  0.0105370948
##  [38,]  0.0048110702
##  [39,] -0.0493539995
##  [40,] -0.0369967001
##  [41,]  0.1287759263
##  [42,]  0.1262136744
##  [43,]  0.0171370879
##  [44,] -0.0009551301
##  [45,]  0.0073895546
##  [46,]  0.0059255193
##  [47,]  0.0356150640
##  [48,] -0.0103712559
##  [49,]  0.0378118333
##  [50,]  0.0196694956
##  [51,] -0.3643819855
##  [52,] -0.0140581920
##  [53,]  0.0677115556
##  [54,]  0.0308920798
##  [55,] -0.0031484834
##  [56,] -0.0065790845
##  [57,]  0.0418105255
##  [58,]  0.0327761180
##  [59,] -0.0054623859
##  [60,] -0.0240457214
##  [61,] -0.0411726554
##  [62,]  0.0223812224
##  [63,]  0.0517388918
##  [64,]  0.0069679988
##  [65,] -0.0037223047
##  [66,]  0.0539758453
##  [67,] -0.0379577442
##  [68,]  0.0661990354
##  [69,] -0.0282733804
##  [70,] -0.3611457840
##  [71,] -0.0164028951
##  [72,]  0.0130057280
##  [73,]  0.1003928663
##  [74,]  0.0537932747
##  [75,]  0.0661890678
##  [76,]  0.0431155851
##  [77,]  0.0373258557
##  [78,]  0.0660130090
##  [79,] -0.0828272512
##  [80,]  0.0004905875
##  [81,]  0.0272742749
##  [82,]  0.0651431254
##  [83,]  0.0616788142
##  [84,] -0.0298786368
##  [85,] -0.0316983767
##  [86,] -0.0033368147
##  [87,]  0.0087756853
##  [88,]  0.0023950673
##  [89,] -0.0271306388
##  [90,] -0.0007756615
##  [91,] -0.3344325034
##  [92,] -0.0283281104
##  [93,]  0.0052999238
##  [94,]  0.1031673620
##  [95,]  0.0130727427
##  [96,] -0.0254776265
##  [97,]  0.0668967945
##  [98,] -0.0736009161
##  [99,]  0.0542712751
## [100,]  0.0104927587
## [101,] -0.0020123860
## [102,] -0.0033674833
## [103,]  0.0887082041
## [104,]  0.0142354972
## [105,]  0.0685101073
## [106,]  0.0152896254
## [107,] -0.0392761964
## [108,]  0.0571694552
## [109,]  0.0457617146
## [110,] -0.0040356033
## [111,] -0.0371800914
## [112,]  0.0384918599
## [113,]  0.0168308277
## [114,] -0.0256044965
## [115,]  0.0255912055</code></pre>
<ul>
<li>Karate dataset:该数据集包含了由Wayne
Zachary于1977年描述的美国大学一个空手道俱乐部的34名成员之间的友谊网络。数据类型为igraph中图。结果k为2.</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">data</span>(karate)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>karate_mat<span class="ot">=</span><span class="fu">get.adjacency</span>(karate,<span class="at">sparse =</span> <span class="cn">FALSE</span>)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="fu">RS_PA</span>(karate_mat,<span class="dv">300</span>,<span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## $k
## [1] 2
## 
## $embedding_mat
##              [,1]        [,2]
##  [1,] -0.35549144  0.38686107
##  [2,] -0.26595992  0.26893952
##  [3,] -0.31719250  0.13115956
##  [4,] -0.21117972  0.25294583
##  [5,] -0.07596882  0.13389698
##  [6,] -0.07948305  0.14565715
##  [7,] -0.07948305  0.14565715
##  [8,] -0.17095975  0.20893922
##  [9,] -0.22740391 -0.05501457
## [10,] -0.10267425 -0.04810648
## [11,] -0.07596882  0.13389698
## [12,] -0.05285570  0.07772861
## [13,] -0.08425463  0.12855081
## [14,] -0.22647272  0.13447999
## [15,] -0.10140326 -0.13966939
## [16,] -0.10140326 -0.13966939
## [17,] -0.02363563  0.05853123
## [18,] -0.09239954  0.13176428
## [19,] -0.10140326 -0.13966939
## [20,] -0.14791251  0.05730506
## [21,] -0.10140326 -0.13966939
## [22,] -0.09239954  0.13176428
## [23,] -0.10140326 -0.13966939
## [24,] -0.15011857 -0.21704695
## [25,] -0.05705244 -0.05641262
## [26,] -0.05920647 -0.07548493
## [27,] -0.07557941 -0.11596526
## [28,] -0.13347715 -0.10305032
## [29,] -0.13107782 -0.06864757
## [30,] -0.13496082 -0.20657862
## [31,] -0.17475830 -0.09668732
## [32,] -0.19103384 -0.10223455
## [33,] -0.30864422 -0.32455583
## [34,] -0.37336347 -0.37058908</code></pre>
<ul>
<li>Polbooks
dataset:关于美国政治的图书网络，节点表示由在线书商Amazon.com销售的有关美国政治的图书。边表示相同购买者频繁共同购买书籍，如在Amazon上的“购买了此书的顾客也购买了这些其他书籍”功能中所示。数据类型为igraph中图。结果k为2.</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">data</span>(polbooks)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>polbooks_mat<span class="ot">=</span><span class="fu">get.adjacency</span>(polbooks,<span class="at">sparse =</span> <span class="cn">FALSE</span>)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="fu">RS_PA</span>(polbooks_mat,<span class="dv">300</span>,<span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## $k
## [1] 2
## 
## $embedding_mat
##                [,1]          [,2]
##   [1,] -0.016790919  0.0371553401
##   [2,] -0.012268216  0.0359533266
##   [3,] -0.011846262  0.0081190559
##   [4,] -0.076940397  0.2651451552
##   [5,] -0.046644200  0.0070499684
##   [6,] -0.021178537  0.0381083854
##   [7,] -0.031482286  0.0773572142
##   [8,] -0.056743457  0.0120271254
##   [9,] -0.090743329  0.3261043870
##  [10,] -0.066473519  0.2070408313
##  [11,] -0.049668751  0.1782713649
##  [12,] -0.070245080  0.2463166559
##  [13,] -0.086612146  0.3114780091
##  [14,] -0.051494212  0.1866439566
##  [15,] -0.048316680  0.1382242373
##  [16,] -0.020142442  0.0732889343
##  [17,] -0.012298340  0.0444681370
##  [18,] -0.029386078  0.1074526484
##  [19,] -0.016344658  0.0562821407
##  [20,] -0.020570531  0.0438712767
##  [21,] -0.046440186  0.1368933094
##  [22,] -0.027496420  0.1003529853
##  [23,] -0.031431853  0.1073837613
##  [24,] -0.040507168  0.1502318592
##  [25,] -0.048285051  0.1658624730
##  [26,] -0.021234350  0.0706313959
##  [27,] -0.044633900  0.1539799703
##  [28,] -0.045539244  0.1649060658
##  [29,] -0.047966625 -0.0128093393
##  [30,] -0.016749510  0.0445251387
##  [31,] -0.258593969 -0.0710991547
##  [32,] -0.151980074 -0.0394382743
##  [33,] -0.025619078  0.0955907166
##  [34,] -0.036346232  0.1362751794
##  [35,] -0.010421897  0.0402178248
##  [36,] -0.029774745  0.1117508384
##  [37,] -0.019391613  0.0727513719
##  [38,] -0.025525553  0.0960147881
##  [39,] -0.022270645  0.0840599229
##  [40,] -0.027398133  0.1027412714
##  [41,] -0.065210521  0.2326037426
##  [42,] -0.039222751  0.1429194288
##  [43,] -0.026626961  0.0991636575
##  [44,] -0.017522107  0.0651750093
##  [45,] -0.027138597  0.1005691282
##  [46,] -0.033745092  0.1209178928
##  [47,] -0.021990712  0.0755171091
##  [48,] -0.065361487  0.2389814486
##  [49,] -0.016656869  0.0345868862
##  [50,] -0.069540308  0.0223172892
##  [51,] -0.016730396  0.0401693690
##  [52,] -0.019616328  0.0213190543
##  [53,] -0.019208841  0.0296062278
##  [54,] -0.033752372  0.0550417530
##  [55,] -0.028698887  0.1068119533
##  [56,] -0.014832758  0.0522311858
##  [57,] -0.010445642  0.0336498131
##  [58,] -0.016306309  0.0356370665
##  [59,] -0.062919096  0.0133976646
##  [60,] -0.027771264 -0.0090390870
##  [61,] -0.063333561 -0.0202431949
##  [62,] -0.026267861 -0.0083567389
##  [63,] -0.060885117 -0.0196010318
##  [64,] -0.025740134 -0.0083768880
##  [65,] -0.048771280 -0.0051264640
##  [66,] -0.023269842  0.0003179679
##  [67,] -0.254886026 -0.0768646375
##  [68,] -0.049937440 -0.0133438629
##  [69,] -0.026958538 -0.0038354145
##  [70,] -0.013431895  0.0024843286
##  [71,] -0.111741834 -0.0326491919
##  [72,] -0.186726152 -0.0531554517
##  [73,] -0.270837966 -0.0790257355
##  [74,] -0.284135195 -0.0874495218
##  [75,] -0.241949526 -0.0739526904
##  [76,] -0.237598483 -0.0707060326
##  [77,] -0.198185046 -0.0497720228
##  [78,] -0.093573081 -0.0195273902
##  [79,] -0.091270057 -0.0272191856
##  [80,] -0.147830675 -0.0451338584
##  [81,] -0.081377179 -0.0241095294
##  [82,] -0.064734653 -0.0201675211
##  [83,] -0.178246716 -0.0530445551
##  [84,] -0.142952473 -0.0430837342
##  [85,] -0.296946459 -0.0917617910
##  [86,] -0.056035941 -0.0112006210
##  [87,] -0.189235583 -0.0579871869
##  [88,] -0.086043517 -0.0267918696
##  [89,] -0.099016789 -0.0308172553
##  [90,] -0.116911152 -0.0364817434
##  [91,] -0.075960557 -0.0233956360
##  [92,] -0.113786060 -0.0348567718
##  [93,] -0.066420509 -0.0204120355
##  [94,] -0.103667044 -0.0313463653
##  [95,] -0.075322326 -0.0233014361
##  [96,] -0.033975360 -0.0101712810
##  [97,] -0.097916980 -0.0310418540
##  [98,] -0.099546745 -0.0314356816
##  [99,] -0.074039398 -0.0234889587
## [100,] -0.155157660 -0.0484534313
## [101,] -0.157570756 -0.0498832944
## [102,] -0.062462569 -0.0199050643
## [103,] -0.019690157  0.0009206818
## [104,] -0.004662741 -0.0012379849
## [105,] -0.005701346 -0.0010411234</code></pre>
</div>
</div>
</div>
<div id="函数2communityc" class="section level2">
<h2>函数2：CommunityC</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co">#include &lt;Rcpp.h&gt;</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>using namespace Rcpp;</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="sc">/</span><span class="er">/</span> [[Rcpp<span class="sc">::</span>export]]</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>List <span class="fu">CommunityC</span>(NumericMatrix embedding_mat, int k, int iter, CharacterVector s) {</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>  int n <span class="ot">=</span> <span class="fu">embedding_mat.nrow</span>();</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>  int p <span class="ot">=</span> <span class="fu">embedding_mat.ncol</span>();</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>  IntegerVector seq <span class="ot">=</span> <span class="fu">seq_len</span>(n);</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>  NumericVector x<span class="ot">=</span>as<span class="sc">&lt;</span>NumericVector<span class="sc">&gt;</span>(seq);</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>  NumericVector ind<span class="ot">=</span><span class="fu">sample</span>(x,k,false,R_NilValue);</span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>  NumericMatrix <span class="fu">centroids</span>(k, p);</span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>  <span class="cf">for</span> (int <span class="at">i =</span> <span class="dv">0</span>; i <span class="sc">&lt;</span> k; i<span class="sc">++</span>) {</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a>    <span class="fu">centroids</span>(i, _) <span class="ot">=</span> <span class="fu">embedding_mat</span>(ind[i], _);</span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>  }</span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a>  IntegerVector <span class="fu">assignments</span>(n);</span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a>  <span class="cf">for</span> (int <span class="at">iteration =</span> <span class="dv">0</span>; iteration <span class="sc">&lt;</span> iter; iteration<span class="sc">++</span>) {</span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a>    NumericMatrix <span class="fu">distances</span>(n, k);</span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a>    <span class="cf">for</span> (int <span class="at">i =</span> <span class="dv">0</span>; i <span class="sc">&lt;</span> k; i<span class="sc">++</span>) {</span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a>      <span class="cf">for</span> (int <span class="at">j =</span> <span class="dv">0</span>; j <span class="sc">&lt;</span> n; j<span class="sc">++</span>) {</span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a>        <span class="fu">distances</span>(j, i) <span class="ot">=</span> <span class="fu">euclidean_distance</span>(<span class="fu">embedding_mat</span>(j, _), <span class="fu">centroids</span>(i, _));</span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a>      }</span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a>    }</span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a>    <span class="cf">for</span> (int <span class="at">j =</span> <span class="dv">0</span>; j <span class="sc">&lt;</span> n; <span class="sc">++</span>j) {</span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a>      assignments[j] <span class="ot">=</span> <span class="fu">which_min</span>(<span class="fu">distances</span>(j, _));</span>
<span id="cb18-24"><a href="#cb18-24" tabindex="-1"></a>    }</span>
<span id="cb18-25"><a href="#cb18-25" tabindex="-1"></a>    <span class="cf">for</span> (int <span class="at">i =</span> <span class="dv">0</span>; i <span class="sc">&lt;</span> k; <span class="sc">++</span>i) {</span>
<span id="cb18-26"><a href="#cb18-26" tabindex="-1"></a>      NumericVector <span class="fu">centroid_update</span>(p, <span class="fl">0.0</span>);</span>
<span id="cb18-27"><a href="#cb18-27" tabindex="-1"></a>      int count <span class="ot">=</span> <span class="dv">0</span>;</span>
<span id="cb18-28"><a href="#cb18-28" tabindex="-1"></a>      <span class="cf">for</span> (int <span class="at">j =</span> <span class="dv">0</span>; j <span class="sc">&lt;</span> n; <span class="sc">++</span>j) {</span>
<span id="cb18-29"><a href="#cb18-29" tabindex="-1"></a>        <span class="cf">if</span> (assignments[j] <span class="sc">==</span> i) {</span>
<span id="cb18-30"><a href="#cb18-30" tabindex="-1"></a>          <span class="cf">for</span> (int <span class="at">l =</span> <span class="dv">0</span>; l <span class="sc">&lt;</span> p; <span class="sc">++</span>l) {</span>
<span id="cb18-31"><a href="#cb18-31" tabindex="-1"></a>            centroid_update[l] <span class="sc">+</span><span class="er">=</span> <span class="fu">embedding_mat</span>(j, l);</span>
<span id="cb18-32"><a href="#cb18-32" tabindex="-1"></a>          }</span>
<span id="cb18-33"><a href="#cb18-33" tabindex="-1"></a>          count<span class="sc">++</span>;</span>
<span id="cb18-34"><a href="#cb18-34" tabindex="-1"></a>        }</span>
<span id="cb18-35"><a href="#cb18-35" tabindex="-1"></a>      }</span>
<span id="cb18-36"><a href="#cb18-36" tabindex="-1"></a>      <span class="cf">if</span> (count <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb18-37"><a href="#cb18-37" tabindex="-1"></a>        <span class="cf">for</span> (int <span class="at">l =</span> <span class="dv">0</span>; l <span class="sc">&lt;</span> p; <span class="sc">++</span>l) {</span>
<span id="cb18-38"><a href="#cb18-38" tabindex="-1"></a>          <span class="fu">centroids</span>(i, l) <span class="ot">=</span> centroid_update[l] <span class="sc">/</span> count;</span>
<span id="cb18-39"><a href="#cb18-39" tabindex="-1"></a>        }</span>
<span id="cb18-40"><a href="#cb18-40" tabindex="-1"></a>      }</span>
<span id="cb18-41"><a href="#cb18-41" tabindex="-1"></a>    }</span>
<span id="cb18-42"><a href="#cb18-42" tabindex="-1"></a>  }</span>
<span id="cb18-43"><a href="#cb18-43" tabindex="-1"></a>  List <span class="fu">result</span>(k);</span>
<span id="cb18-44"><a href="#cb18-44" tabindex="-1"></a>  <span class="cf">for</span> (int <span class="at">i =</span> <span class="dv">0</span>; i <span class="sc">&lt;</span> k; <span class="sc">++</span>i) {</span>
<span id="cb18-45"><a href="#cb18-45" tabindex="-1"></a>    CharacterVector group_members <span class="ot">=</span> s[assignments <span class="sc">==</span> i];</span>
<span id="cb18-46"><a href="#cb18-46" tabindex="-1"></a>    result[i] <span class="ot">=</span> group_members;</span>
<span id="cb18-47"><a href="#cb18-47" tabindex="-1"></a>  }</span>
<span id="cb18-48"><a href="#cb18-48" tabindex="-1"></a>  return result;</span>
<span id="cb18-49"><a href="#cb18-49" tabindex="-1"></a>}</span></code></pre></div>
<div id="函数2背景" class="section level3">
<h3>函数2背景：</h3>
<p>通过上面的RS_PA函数我们对于一个随机图可以估计它潜在的社区数，并且我们可以得到每个节点在低维空间的嵌入向量所构成的嵌入矩阵，所以通过对嵌入向量进行k-means聚类算法，我们可以得到随机图的社区检测结果，即将多有在同一社区的节点归类在一起，我们构造函数CommunityC来实现上述目的，输出为在同一社区的节点放在一起最终得到的列表，列表中每个元素为同一社区节点的名称构成的字符串数组</p>
</div>
<div id="函数2说明" class="section level3">
<h3>函数2说明：</h3>
<div id="输入-1" class="section level4">
<h4>输入：</h4>
<ul>
<li>k:通过上述背景中Random
Signflip平行分析得到的随机图邻接矩阵的显著特征值的个数，即随机图中潜在的社区个数</li>
<li>embedding_mat:通过上述方法获得潜在社区数k之后，通过PCA取前k列特征作为每个节点的嵌入向量得到的嵌入矩阵</li>
<li>iter:k-means算法迭代的次数</li>
<li>s:每个节点对应的名称构成的字符串数组</li>
</ul>
</div>
<div id="输出-1" class="section level4">
<h4>输出：</h4>
<ul>
<li>result:通过上述背景中Random
Signflip平行分析得到的随机图邻接矩阵的显著特征值的个数k，以及利用k-means算法进行聚类实现社区检验，将结果中在同一社区的节点放在一起最终得到的列表，列表中每个元素为同一社区节点的名称构成的字符串数组</li>
</ul>
</div>
</div>
<div id="函数2例子" class="section level3">
<h3>函数2例子：</h3>
<div id="模拟数据-1" class="section level4">
<h4>模拟数据：</h4>
<ul>
<li>创建一个embedding_mat，取定embedding_mat为n=100行，p=3列，取节点名字为node+编号，取定社区数为3，迭代次数为50</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>embedding_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> p), <span class="at">nrow =</span> n, <span class="at">ncol =</span> p)</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;node&quot;</span>, <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>iter <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a><span class="fu">CommunityC</span>(embedding_mat, k, iter, s)</span></code></pre></div>
<pre><code>## [[1]]
##  [1] &quot;node3&quot;  &quot;node4&quot;  &quot;node5&quot;  &quot;node6&quot;  &quot;node11&quot; &quot;node15&quot; &quot;node16&quot; &quot;node19&quot;
##  [9] &quot;node21&quot; &quot;node25&quot; &quot;node30&quot; &quot;node34&quot; &quot;node36&quot; &quot;node37&quot; &quot;node43&quot; &quot;node47&quot;
## [17] &quot;node54&quot; &quot;node55&quot; &quot;node58&quot; &quot;node61&quot; &quot;node62&quot; &quot;node64&quot; &quot;node65&quot; &quot;node66&quot;
## [25] &quot;node72&quot; &quot;node78&quot; &quot;node81&quot; &quot;node83&quot; &quot;node84&quot; &quot;node85&quot; &quot;node86&quot; &quot;node91&quot;
## [33] &quot;node92&quot; &quot;node99&quot;
## 
## [[2]]
##  [1] &quot;node2&quot;   &quot;node7&quot;   &quot;node9&quot;   &quot;node12&quot;  &quot;node13&quot;  &quot;node14&quot;  &quot;node17&quot; 
##  [8] &quot;node18&quot;  &quot;node20&quot;  &quot;node23&quot;  &quot;node24&quot;  &quot;node28&quot;  &quot;node29&quot;  &quot;node32&quot; 
## [15] &quot;node38&quot;  &quot;node39&quot;  &quot;node40&quot;  &quot;node44&quot;  &quot;node45&quot;  &quot;node46&quot;  &quot;node48&quot; 
## [22] &quot;node50&quot;  &quot;node52&quot;  &quot;node56&quot;  &quot;node57&quot;  &quot;node59&quot;  &quot;node60&quot;  &quot;node67&quot; 
## [29] &quot;node69&quot;  &quot;node70&quot;  &quot;node73&quot;  &quot;node74&quot;  &quot;node75&quot;  &quot;node77&quot;  &quot;node79&quot; 
## [36] &quot;node80&quot;  &quot;node82&quot;  &quot;node88&quot;  &quot;node94&quot;  &quot;node97&quot;  &quot;node100&quot;
## 
## [[3]]
##  [1] &quot;node1&quot;  &quot;node8&quot;  &quot;node10&quot; &quot;node22&quot; &quot;node26&quot; &quot;node27&quot; &quot;node31&quot; &quot;node33&quot;
##  [9] &quot;node35&quot; &quot;node41&quot; &quot;node42&quot; &quot;node49&quot; &quot;node51&quot; &quot;node53&quot; &quot;node63&quot; &quot;node68&quot;
## [17] &quot;node71&quot; &quot;node76&quot; &quot;node87&quot; &quot;node89&quot; &quot;node90&quot; &quot;node93&quot; &quot;node95&quot; &quot;node96&quot;
## [25] &quot;node98&quot;</code></pre>
</div>
<div id="真实数据-1" class="section level4">
<h4>真实数据：</h4>
<ul>
<li>Dolphins dataset:</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">data</span>(dolphins)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>dolphins_mat<span class="ot">=</span><span class="fu">get.adjacency</span>(dolphins,<span class="at">sparse =</span> <span class="cn">FALSE</span>)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>s<span class="ot">=</span><span class="fu">get.vertex.attribute</span>(dolphins)<span class="sc">$</span>label</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>k<span class="ot">=</span><span class="fu">RS_PA</span>(dolphins_mat,<span class="dv">300</span>,<span class="fl">0.95</span>)<span class="sc">$</span>k</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>embedding_mat<span class="ot">=</span><span class="fu">RS_PA</span>(dolphins_mat,<span class="dv">300</span>,<span class="fl">0.95</span>)<span class="sc">$</span>embedding_mat</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>iter <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="fu">CommunityC</span>(embedding_mat, k, iter, s)</span></code></pre></div>
<pre><code>## [[1]]
##  [1] &quot;Beak&quot;     &quot;Grin&quot;     &quot;Hook&quot;     &quot;Kringel&quot;  &quot;Scabs&quot;    &quot;Shmuddel&quot;
##  [7] &quot;SN4&quot;      &quot;SN63&quot;     &quot;SN9&quot;      &quot;Stripes&quot;  &quot;Thumper&quot;  &quot;TR99&quot;    
## [13] &quot;TSN103&quot;  
## 
## [[2]]
## [1] &quot;Haecksel&quot;  &quot;Jonah&quot;     &quot;MN105&quot;     &quot;MN60&quot;      &quot;MN83&quot;      &quot;Patchback&quot;
## [7] &quot;Topless&quot;   &quot;Trigger&quot;  
## 
## [[3]]
##  [1] &quot;Beescratch&quot;  &quot;Bumper&quot;      &quot;CCL&quot;         &quot;Cross&quot;       &quot;DN16&quot;       
##  [6] &quot;DN21&quot;        &quot;DN63&quot;        &quot;Double&quot;      &quot;Feather&quot;     &quot;Fish&quot;       
## [11] &quot;Five&quot;        &quot;Fork&quot;        &quot;Gallatin&quot;    &quot;Jet&quot;         &quot;Knit&quot;       
## [16] &quot;MN23&quot;        &quot;Mus&quot;         &quot;Notch&quot;       &quot;Number1&quot;     &quot;Oscar&quot;      
## [21] &quot;PL&quot;          &quot;Quasi&quot;       &quot;Ripplefluke&quot; &quot;SMN5&quot;        &quot;SN100&quot;      
## [26] &quot;SN89&quot;        &quot;SN90&quot;        &quot;SN96&quot;        &quot;TR120&quot;       &quot;TR77&quot;       
## [31] &quot;TR82&quot;        &quot;TR88&quot;        &quot;TSN83&quot;       &quot;Upbang&quot;      &quot;Vau&quot;        
## [36] &quot;Wave&quot;        &quot;Web&quot;         &quot;Whitetip&quot;    &quot;Zap&quot;         &quot;Zig&quot;        
## [41] &quot;Zipfel&quot;</code></pre>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
